doctype html
html(lang="en")
  head
    meta(charset="utf-8")
    title= htmlWebpackPlugin.options.title
  body(bload)
    noscript Javascript not started
    h1= htmlWebpackPlugin.options.title
    form(onsubmit="return false")
      label(for="country") Your country:
      input(id="country" bbind="country" placeholder="Type here" title="Hit enter to add" onkeyup="addCountry(event)")
    h2
      | Your country is 
      span(bval="country")
    ul(class="country-list" bif="countries")
      li.country(bfor="countries" battr="name=${$value.name}|id=country-${$index}|class=country removable")
        span(bval="$index")
        | . 
        span(bval="$value.name")
        span(style="padding-left: 1rem; cursor: pointer; user-select: none; color: red;" battr="data-index=${$index}" onclick="removeCountry(event)")
          | × Remove
        ul(class="zone-list")
          li.zone(bfor="$value.zones")
            span(bval="$value")
            |  − test super, literal and filter: 
            span(bval="$super.$value.name|add:': it%qs a tyranny!'|capitalize")
    script.
      function addCountry(event) {
        if (event.key == "Enter" && event.target.value) {
          const countryObj = {
            name: event.target.value,
            zones: ['zone1', 'zone2', 'zone3'],
          }
          this.scope.countries.push(countryObj);
          this.scope.country = '';
        }
      }
      function removeCountry(event) {
        const index = event.target.dataset.index;
        console.log(`country ${this.scope.countries[index]} removed`);
        this.scope.countries.splice(index, 1);
      }
      document.addEventListener(window.Bjs.READY_EVENT, (event) => {
        const b = event.detail;
        for (let f of ['addCountry', 'removeCountry']) {
          window[f] = window[f].bind(b);
        }
        b.watchers.country.push((value, old) => console.log(`country: ${old} -> ${value}`)); 
        b.watchers.countries.push((value, old) => console.log(`countries: ${old} -> ${value}`)); 
        b.scope.countries = [];
      });
